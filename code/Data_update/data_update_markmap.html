<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"Data Update Analysis","children":[{"content":"1. Overall Structure and Purpose:","children":[],"payload":{"tag":"h2","lines":"2,3"}},{"content":"2. Key Components and Files:","children":[{"content":"<strong><code>update_main.py</code>:</strong> This is a central script that orchestrates the data update process. It defines functions for different update schedules (7:05, 15:15, 18:00) and a main function (<code>daily_update_auto</code>) that determines which update to run based on the current time. It also includes a <code>daily_update_l4</code> function for L4 data updates.","children":[],"payload":{"tag":"li","lines":"8,9"}},{"content":"<strong><code>history_main.py</code>:</strong> This script seems to handle historical data updates. It calls functions from various submodules to update historical market data, factor data, scores, time series data, and L4 data.","children":[],"payload":{"tag":"li","lines":"9,10"}},{"content":"<strong>Batch files (<code>.bat</code>):</strong> Several batch files are present, such as <code>daily_update_l4_test&amp;product_tracking_main.bat</code>, <code>data_update_test.bat</code>, etc. These files are used to execute the Python scripts, likely through Anaconda. They set up the environment (e.g., <code>PYTHONPATH</code>, <code>ANACONDAPATH</code>) and then run the appropriate Python function.","children":[],"payload":{"tag":"li","lines":"10,11"}},{"content":"<strong>XML files (<code>.xml</code>):</strong> Files like <code>daily_update_l4_test&amp;product_tracking_main.xml</code> and <code>data_update_test.xml</code> are task scheduler configuration files. They define the schedule and settings for automated execution of the corresponding batch files.","children":[],"payload":{"tag":"li","lines":"11,12"}},{"content":"<strong>Subdirectories:</strong> The folder contains several subdirectories, each responsible for updating a specific type of data:","children":[{"content":"<code>FactorData_update</code>: Updates factor data.","children":[],"payload":{"tag":"li","lines":"13,14"}},{"content":"<code>MktData_update</code>: Updates market data.","children":[],"payload":{"tag":"li","lines":"14,15"}},{"content":"<code>Score_update</code>: Updates scores.","children":[],"payload":{"tag":"li","lines":"15,16"}},{"content":"<code>File_moving</code>: Moves files.","children":[],"payload":{"tag":"li","lines":"16,17"}},{"content":"<code>L4Data_update</code>: Updates L4 data.","children":[],"payload":{"tag":"li","lines":"17,18"}},{"content":"<code>TimeSeries_update</code>: Updates time series data.","children":[],"payload":{"tag":"li","lines":"18,19"}},{"content":"<code>Time_tools</code>: Provides time-related utility functions.","children":[],"payload":{"tag":"li","lines":"19,20"}},{"content":"<code>Data_checking</code>: Checks data quality.","children":[],"payload":{"tag":"li","lines":"20,21"}},{"content":"<code>global_tools_func</code>: Contains global utility functions.","children":[],"payload":{"tag":"li","lines":"21,22"}},{"content":"<code>config_project</code>: Contains configuration files.","children":[],"payload":{"tag":"li","lines":"22,23"}},{"content":"<code>config_path</code>: Contains path configuration files.","children":[],"payload":{"tag":"li","lines":"23,24"}},{"content":"<code>auto</code>: Contains <code>main.py</code> which is likely related to automated tasks.","children":[],"payload":{"tag":"li","lines":"24,26"}}],"payload":{"tag":"li","lines":"12,26"}}],"payload":{"tag":"h2","lines":"6,7"}},{"content":"3. Detailed Function Chart:","children":[{"content":"<pre data-lines=\"28,190\"><code data-lines=\"28,190\">Data_update\n&#x251c;&#x2500;&#x2500; update_main<span class=\"hljs-selector-class\">.py</span>\n&#x2502;   &#x251c;&#x2500;&#x2500; <span class=\"hljs-built_in\">daily_update_705</span>()\n&#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; time_tools<span class=\"hljs-selector-class\">.target_date_decision_705</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; time_tools_config<span class=\"hljs-selector-class\">.xlsx</span> (read)\n&#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; global_tools<span class=\"hljs-selector-class\">.is_workday2</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; global_tools<span class=\"hljs-selector-class\">.next_workday_calculate</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; global_tools<span class=\"hljs-selector-class\">.strdate_transfer</span>()\n&#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; global_tools<span class=\"hljs-selector-class\">.strdate_transfer</span>()\n&#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; <span class=\"hljs-built_in\">score_update_main</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; rrScore_update<span class=\"hljs-selector-class\">.rr_update_main</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; scorePortfolio_update<span class=\"hljs-selector-class\">.scorePortfolio_update_main</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; combineScore_update<span class=\"hljs-selector-class\">.score_combination_main</span>()\n&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; checking<span class=\"hljs-selector-class\">.checking_main</span>()\n&#x2502;   &#x251c;&#x2500;&#x2500; <span class=\"hljs-built_in\">daily_update_1515</span>()\n&#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; time_tools<span class=\"hljs-selector-class\">.target_date_decision_1515</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; time_tools_config<span class=\"hljs-selector-class\">.xlsx</span> (read)\n&#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; global_tools<span class=\"hljs-selector-class\">.is_workday2</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; global_tools<span class=\"hljs-selector-class\">.last_workday_calculate</span>()\n&#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; global_tools<span class=\"hljs-selector-class\">.strdate_transfer</span>()\n&#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; <span class=\"hljs-built_in\">MktData_update_main</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; indexReturn_update<span class=\"hljs-selector-class\">.index_return_update_main</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; indexComponent_update<span class=\"hljs-selector-class\">.index_component_update_main</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; stockData_update<span class=\"hljs-selector-class\">.stock_data_update_main</span>()\n&#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; checking<span class=\"hljs-selector-class\">.checking_main</span>()\n&#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; <span class=\"hljs-built_in\">timeSeries_update_main_part1</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; <span class=\"hljs-built_in\">index_return_update</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; output_indexreturn (read)\n&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; output_timeseries/index_return<span class=\"hljs-selector-class\">.csv</span> (write)\n&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; <span class=\"hljs-built_in\">stock_data_update</span>()\n&#x2502;   &#x2502;   &#x2502;       &#x251c;&#x2500;&#x2500; data_other/StockUniverse_new<span class=\"hljs-selector-class\">.csv</span> (read)\n&#x2502;   &#x2502;   &#x2502;       &#x251c;&#x2500;&#x2500; output_stockreturn (read)\n&#x2502;   &#x2502;   &#x2502;       &#x251c;&#x2500;&#x2500; output_stockclose (read)\n&#x2502;   &#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; output_timeseries/stock_return<span class=\"hljs-selector-class\">.csv</span> (write)\n&#x2502;   &#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; output_timeseries/stock_close<span class=\"hljs-selector-class\">.csv</span> (write)\n&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; File_moving<span class=\"hljs-selector-class\">.file_moving_update_main</span>()\n&#x2502;   &#x2502;       &#x251c;&#x2500;&#x2500; <span class=\"hljs-built_in\">data_realtime_moving</span>()\n&#x2502;   &#x2502;       &#x2502;   &#x251c;&#x2500;&#x2500; input_realtime (read)\n&#x2502;   &#x2502;       &#x2502;   &#x2514;&#x2500;&#x2500; output_realtime (write)\n&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; <span class=\"hljs-built_in\">data_cbond_moving</span>()\n&#x2502;   &#x2502;           &#x251c;&#x2500;&#x2500; input_cbond (read)\n&#x2502;   &#x2502;           &#x2514;&#x2500;&#x2500; output_cbond (write)\n&#x2502;   &#x251c;&#x2500;&#x2500; <span class=\"hljs-built_in\">daily_update_1800</span>()\n&#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; time_tools<span class=\"hljs-selector-class\">.target_date_decision_1800</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; time_tools_config<span class=\"hljs-selector-class\">.xlsx</span> (read)\n&#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; global_tools<span class=\"hljs-selector-class\">.is_workday2</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; global_tools<span class=\"hljs-selector-class\">.last_workday_calculate</span>()\n&#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; global_tools<span class=\"hljs-selector-class\">.strdate_transfer</span>()\n&#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; FactorData_update<span class=\"hljs-selector-class\">.FactorData_update_main</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; <span class=\"hljs-built_in\">factor_update_main</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; data_source_priority<span class=\"hljs-selector-class\">.xlsx</span> (read)\n&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; FactorData_prepare<span class=\"hljs-selector-class\">.jy_factor_exposure_update</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; FactorData_prepare<span class=\"hljs-selector-class\">.wind_factor_exposure_update</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; output_factor_exposure (write)\n&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; output_factor_return (write)\n&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; output_factor_stockpool (write)\n&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; output_factor_cov (write)\n&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; output_factor_specific_risk (write)\n&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; <span class=\"hljs-built_in\">index_factor_update_main</span>()\n&#x2502;   &#x2502;   &#x2502;       &#x251c;&#x2500;&#x2500; data_source_priority<span class=\"hljs-selector-class\">.xlsx</span> (read)\n&#x2502;   &#x2502;   &#x2502;       &#x251c;&#x2500;&#x2500; FactorData_prepare<span class=\"hljs-selector-class\">.jy_factor_index_exposure_update</span>()\n&#x2502;   &#x2502;   &#x2502;       &#x251c;&#x2500;&#x2500; FactorData_prepare<span class=\"hljs-selector-class\">.wind_factor_index_exposure_update</span>()\n&#x2502;   &#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; output_indexexposure (write)\n&#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; checking<span class=\"hljs-selector-class\">.checking_main</span>()\n&#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; <span class=\"hljs-built_in\">timeSeries_update_main_part2</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; <span class=\"hljs-built_in\">factor_return_update</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; output_factor_return (read)\n&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; output_timeseries/lnmodel<span class=\"hljs-selector-class\">.csv</span> (write)\n&#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; <span class=\"hljs-built_in\">factor_stockpool_update</span>()\n&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; output_factor_stockpool (read)\n&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; output_timeseries/Stock_pool<span class=\"hljs-selector-class\">.csv</span> (write)\n&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; <span class=\"hljs-built_in\">factor_indexexposure_update</span>()\n&#x2502;   &#x2502;   &#x2502;       &#x251c;&#x2500;&#x2500; output_indexexposure (read)\n&#x2502;   &#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; output_timeseries<span class=\"hljs-comment\">/*&#x56e0;&#x5b50;&#x98ce;&#x9669;&#x66b4;&#x9732;.csv (write)\n&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; File_moving.file_moving_update_main()\n&#x2502;   &#x2502;       &#x251c;&#x2500;&#x2500; data_product_moving()\n&#x2502;   &#x2502;       &#x2502;   &#x251c;&#x2500;&#x2500; input_prod (read)\n&#x2502;   &#x2502;       &#x2502;   &#x2514;&#x2500;&#x2500; output_prod (write)\n&#x2502;   &#x251c;&#x2500;&#x2500; daily_update_auto()\n&#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; time_tools.time_zoom_decision()\n&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; time_tools_config.xlsx (read)\n&#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; daily_update_705()  (conditional)\n&#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; daily_update_1515() (conditional)\n&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; daily_update_1800() (conditional)\n&#x2502;   &#x2514;&#x2500;&#x2500; daily_update_l4()\n&#x2502;       &#x2514;&#x2500;&#x2500; L4_update_main()\n&#x2502;           &#x251c;&#x2500;&#x2500; valid_productCode_withdraw()\n&#x2502;           &#x2502;   &#x2514;&#x2500;&#x2500; L4_config.xlsx (read)\n&#x2502;           &#x251c;&#x2500;&#x2500; target_date_decision_L4()\n&#x2502;           &#x251c;&#x2500;&#x2500; L4_running_main()\n&#x2502;           &#x2502;   &#x251c;&#x2500;&#x2500; L4Data_preparing.raw_L4_withdraw()\n&#x2502;   &#x2502;       &#x251c;&#x2500;&#x2500; L4Holding_update.L4Holding_processing()\n&#x2502;   &#x2502;       &#x251c;&#x2500;&#x2500; L4Info_update.L4Info_processing()\n&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; L4Prod_update.holding_diff()\n&#x2514;&#x2500;&#x2500; history_main.py\n    &#x251c;&#x2500;&#x2500; Data_history()\n    &#x2502;   &#x251c;&#x2500;&#x2500; File_moving.file_moving_history_main()\n    &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; data_other_moving()\n    &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; input_destination (read)\n    &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; output_destination (write)\n    &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; data_realtime_moving()\n    &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; input_realtime (read)\n    &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; output_realtime (write)\n    &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; data_cbond_moving()\n    &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; input_cbond (read)\n    &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; output_cbond (write)\n    &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; data_product_moving()\n    &#x2502;   &#x2502;       &#x251c;&#x2500;&#x2500; input_prod (read)\n    &#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; output_prod (write)\n    &#x2502;   &#x251c;&#x2500;&#x2500; MktData_update_main()\n    &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; indexReturn_update.index_return_update_main()\n    &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; indexComponent_update.index_component_update_main()\n    &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; stockData_update.stock_data_update_main()\n    &#x2502;   &#x251c;&#x2500;&#x2500; FactorData_history_main()\n    &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; factor_update_main()\n    &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; data_source_priority.xlsx (read)\n    &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; FactorData_prepare.jy_factor_exposure_update()\n    &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; FactorData_prepare.wind_factor_exposure_update()\n    &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; output_factor_exposure (write)\n    &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; output_factor_return (write)\n    &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; output_factor_stockpool (write)\n    &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; output_factor_cov (write)\n    &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; output_factor_specific_risk (write)\n    &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index_factor_update_main()\n    &#x2502;   &#x2502;       &#x251c;&#x2500;&#x2500; data_source_priority.xlsx (read)\n    &#x2502;   &#x2502;       &#x251c;&#x2500;&#x2500; FactorData_prepare.jy_factor_index_exposure_update()\n    &#x2502;   &#x2502;       &#x251c;&#x2500;&#x2500; FactorData_prepare.wind_factor_index_exposure_update()\n    &#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; output_indexexposure (write)\n    &#x2502;   &#x251c;&#x2500;&#x2500; score_update_main()\n    &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; rrScore_update.rr_update_main()\n    &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; scorePortfolio_update.scorePortfolio_update_main()\n    &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; combineScore_update.score_combination_main()\n    &#x2502;   &#x251c;&#x2500;&#x2500; timeSeries_update_main_part1()\n    &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; index_return_update()\n    &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; output_indexreturn (read)\n    &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; output_timeseries/index_return.csv (write)\n    &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; stock_data_update()\n    &#x2502;   &#x2502;       &#x251c;&#x2500;&#x2500; data_other/StockUniverse_new.csv (read)\n    &#x2502;   &#x2502;       &#x251c;&#x2500;&#x2500; output_stockreturn (read)\n    &#x2502;   &#x2502;       &#x251c;&#x2500;&#x2500; output_stockclose (read)\n    &#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; output_timeseries/stock_return.csv (write)\n    &#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; output_timeseries/stock_close.csv (write)\n    &#x2502;   &#x251c;&#x2500;&#x2500; timeSeries_update_main_part2()\n    &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; factor_return_update()\n    &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; output_factor_return (read)\n    &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; output_timeseries/lnmodel.csv (write)\n    &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; factor_stockpool_update()\n    &#x2502;   &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; output_factor_stockpool (read)\n    &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; output_timeseries/Stock_pool.csv (write)\n    &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; factor_indexexposure_update()\n    &#x2502;   &#x2502;       &#x251c;&#x2500;&#x2500; output_indexexposure (read)\n    &#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; output_timeseries/*&#x56e0;&#x5b50;&#x98ce;&#x9669;&#x66b4;&#x9732;.csv (write)\n    &#x2502;   &#x2514;&#x2500;&#x2500; L4_history_main()\n    &#x2502;       &#x251c;&#x2500;&#x2500; valid_productName_withdraw()\n    &#x2502;       &#x2502;   &#x2514;&#x2500;&#x2500; L4_config.xlsx (read)\n    &#x2502;       &#x251c;&#x2500;&#x2500; L4_running_main()\n    &#x2502;       &#x2502;   &#x251c;&#x2500;&#x2500; L4Data_preparing.raw_L4_withdraw()\n    &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; L4Holding_update.L4Holding_processing()\n    &#x2502;   &#x2502;   &#x251c;&#x2500;&#x2500; L4Info_update.L4Info_processing()\n    &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; L4Prod_update.holding_diff()\n</span></code></pre>","children":[],"payload":{"tag":"pre","lines":"28,190"}}],"payload":{"tag":"h2","lines":"26,27"}},{"content":"4. Detailed Description:","children":[{"content":"<strong><code>update_main.py</code>:</strong> This script is the main entry point for the daily update process. It defines several functions that update different data components:","children":[{"content":"<strong><code>daily_update_705()</code>:</strong> This function updates scores. It determines the target date, updates the scores using <code>score_update_main()</code>, and performs data checking using <code>checking.checking_main()</code>.","children":[],"payload":{"tag":"li","lines":"196,197"}},{"content":"<strong><code>daily_update_1515()</code>:</strong> This function updates market data, time series data and moves files. It determines the target date, updates the market data using <code>MktData_update_main()</code>, updates time series data using <code>timeSeries_update_main_part1()</code>, performs data checking using <code>checking.checking_main()</code>, and moves files using <code>File_moving.file_moving_update_main()</code>.","children":[],"payload":{"tag":"li","lines":"197,198"}},{"content":"<strong><code>daily_update_1800()</code>:</strong> This function updates factor data, time series data and moves files. It determines the target date, updates the factor data using <code>FactorData_update.FactorData_update_main()</code>, updates time series data using <code>timeSeries_update_main_part2()</code>, performs data checking using <code>checking.checking_main()</code>, and moves files using <code>File_moving.file_moving_update_main()</code>.","children":[],"payload":{"tag":"li","lines":"198,199"}},{"content":"<strong><code>daily_update_auto()</code>:</strong> This function acts as a dispatcher, determining which of the above update functions to call based on the current time. It uses the <code>time_tools.time_zoom_decision()</code> function to determine the appropriate time zoom and then calls the corresponding update function.","children":[],"payload":{"tag":"li","lines":"199,200"}},{"content":"<strong><code>daily_update_l4()</code>:</strong> This function updates L4 data by calling <code>L4_update_main()</code>.","children":[],"payload":{"tag":"li","lines":"200,201"}}],"payload":{"tag":"li","lines":"195,201"}},{"content":"<strong><code>history_main.py</code>:</strong> This script is used to update historical data. It defines a <code>Data_history()</code> function that calls functions to update historical market data, factor data, scores, time series data, and L4 data.","children":[],"payload":{"tag":"li","lines":"201,202"}},{"content":"<strong><code>Time_tools/time_tools.py</code>:</strong> This module provides time-related utility functions, including functions to determine the target date for each update routine and to determine the current time zoom.","children":[],"payload":{"tag":"li","lines":"202,203"}},{"content":"<strong><code>FactorData_update/factor_update.py</code>:</strong> This module is responsible for updating factor data. It defines functions to retrieve factor data from different sources (e.g., &apos;jy&apos;, &apos;wind&apos;) and to save the data to CSV files.","children":[],"payload":{"tag":"li","lines":"203,204"}},{"content":"<strong><code>MktData_update/MktData_update_main.py</code>:</strong> This module is responsible for updating market data. It calls functions to update index return, index component, and stock data.","children":[],"payload":{"tag":"li","lines":"204,205"}},{"content":"<strong><code>Score_update/score_update_main.py</code>:</strong> This module is responsible for updating scores. It calls functions to update different score components.","children":[],"payload":{"tag":"li","lines":"205,206"}},{"content":"<strong><code>File_moving/File_moving.py</code>:</strong> This module is responsible for moving files between different directories.","children":[],"payload":{"tag":"li","lines":"206,207"}},{"content":"<strong><code>L4Data_update/L4_running_main.py</code>:</strong> This module is responsible for updating L4 data. It defines functions to retrieve L4 data, process it, and save it to the database.","children":[],"payload":{"tag":"li","lines":"207,208"}},{"content":"<strong><code>TimeSeries_update/time_series_data_update.py</code>:</strong> This module is responsible for updating time series data, including index return, stock data, factor return, factor stock pool, and factor index exposure.","children":[],"payload":{"tag":"li","lines":"208,210"}}],"payload":{"tag":"h2","lines":"191,192"}},{"content":"5. Data Flow:","children":[{"content":"1. The <code>daily_update_auto()</code> function in <code>update_main.py</code> is executed periodically, likely triggered by a task scheduler.","children":[],"payload":{"tag":"li","lines":"214,215","listIndex":1}},{"content":"2. <code>daily_update_auto()</code> determines the appropriate update routine to run based on the current time.","children":[],"payload":{"tag":"li","lines":"215,216","listIndex":2}},{"content":"3. The selected update routine (e.g., <code>daily_update_1515()</code>) is executed.","children":[],"payload":{"tag":"li","lines":"216,217","listIndex":3}},{"content":"4. The update routine calls functions from various submodules to retrieve and process the data.","children":[],"payload":{"tag":"li","lines":"217,218","listIndex":4}},{"content":"5. The data is retrieved from external sources (e.g., JY, Wind) or from local files.","children":[],"payload":{"tag":"li","lines":"218,219","listIndex":5}},{"content":"6. The data is processed and transformed.","children":[],"payload":{"tag":"li","lines":"219,220","listIndex":6}},{"content":"7. The updated data is saved to CSV files or other data stores.","children":[],"payload":{"tag":"li","lines":"220,221","listIndex":7}},{"content":"8. File moving operations are performed to move data files between directories.","children":[],"payload":{"tag":"li","lines":"221,223","listIndex":8}}],"payload":{"tag":"h2","lines":"210,211"}},{"content":"6. Configuration:","children":[],"payload":{"tag":"h2","lines":"223,224"}},{"content":"7. Automation and Scheduling:","children":[],"payload":{"tag":"h2","lines":"227,228"}}],"payload":{"tag":"h1","lines":"0,1"}},{})</script>
</body>
</html>
